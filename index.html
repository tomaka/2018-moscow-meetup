<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
@import url('https://fonts.googleapis.com/css?family=Dosis');

body {
    color: white;
    font-family: Verdana, Geneva, Tahoma, sans-serif;
}

a, a:hover, a:visited, a:active {
    color: lightblue;
}

.remark-slide-number {
    visibility: hidden;
}

.remark-slide-content {
    background-color: #282828;
}

.remark-slide-content h1 {
    font-size: 1.7em;
    margin-bottom: 0.5em;
}

.remark-slide-content h2 {
    font-size: 1.4em;
    margin-bottom: 0.2em;
}

.remark-slide-content table {
    border-collapse: collapse;
}

.remark-slide-content table td, .remark-slide-content table th {
    border: 1px solid black;
    padding: 0.5em;
}

    </style>
  </head>
  <body>
     <textarea id="source">
class: center, middle

# Libp2p, a Rust peer-to-peer library

## RustRush 2018

https://github.com/libp2p/rust-libp2p

<div style="position: absolute; bottom: 5%; right: 5%;">
.right[
    twitter.com/tomaka17 <img src="twitter.png" alt="Twitter" height="16" /><br />
    github.com/tomaka <img src="github.png" alt="GitHub" height="16" /><br />
]
</div>
---

# Why we need decentralized technologies

Examples: BitTorent, Bitcoin.

---

# How a decentralized system works

A decentralized system is generally composed of three or four elements:

- Each node has a *public key*.
- A peer discovery system: how we join the network.
- Optionally, a publish-subscribe system: how we broadcast events over the network.
- Optionally, a distributed hash table (DHT): how we *store* data.

---

# Element #1: public keys

The *identity* of a node on the network is its public key.

Example:

> - Hey! I'm *QmUtAhEaZjCczwvsEDZ2nj9QYFqjcZ9LacWit5P9juNqsC*. Who are you?
> - I'm *QmNpMEWUKmo3PGnyphizqD9i21imhm2wFrfBxd5FDYnkNM*. Nice to meet you!

The format of the public key can be RSA, ed25519, secp256k1, or any asymmetric encryption system.

The public key of a node is strictly enforced by encrypting communications with it. Stealing
a node's identity is impossible.

---

# Element #2: peers discovery

In order to participate in a decentralized network, a machine first needs to discover the
other machines that are part of the network, and how to reach them.

Various methods:

- Discover nodes on the local network through *mDNS* and *DNS-SD*.
- The Internet is very large, so we need *bootstrap nodes*.
- When two nodes are connected, they can share to each other what they know about the rest of
  the network.

---

# Element #3: publish-subscribe system (pub-sub)

Broadcast events through the network so that everyone receives them.

Example usages:

- With a chat application, chat messages are broadcasted on the network.
- In blockchain technologies, a new transaction or a new block has been generated.
- Announce yourself on the network so that other nodes connect to you.

One big challenge is how to propagate messages:

- Who do we connect to?
- How much information do we store locally?
TODO: expand

---

# Element #4: distributed hash table (DHT)

Like a Rust `HashMap`, except that each node stores only a subset of it. The subset that they store
is based on their `PeerId` (ie. their identity).

The further away the hash of a value is, the less chances there is for us to store it.

TODO: expand

---

# Introducing libp2p!

Libp2p is a library for decentralized applications.

- Specifications managed by Protocol Labs (https://protocol.ai/).
- See also https://libp2p.io/

## Rust implementation

- Managed by Parity Tech (https://www.parity.io/).
- https://github.com/libp2p/rust-libp2p
- Still under development, but version 0.1 should be published on crates.io beginning of next year.
- Uses tokio for asynchronous networking.
- Used in practice by Substrate: https://www.parity.io/substrate/
- See the network in action: https://telemetry.polkadot.io/#/Krumme%20Lanke
- Likely to be used by Ethereum 2.0 and by a growing number of projects in the blockchains ecosystem.

<div style="position: absolute; bottom: 5%; right: 5%;">
.right[
    <img src="parity-logo.png" alt="ParityTech" height="100" />
]
</div>
---

# Live demonstration

*(assuming you have Cargo installed)*

Install demo chat application:

```sh
cargo install --git https://github.com/tomaka/2018-rustrush-demo
```

Run it:

```sh
rustrush-demo
```

How it works:

- Uses mDNS to discover nodes on the local network.
- Maintains a connection to every single node it discovers.
- Broadcasts sent messages to all the nodes it is connected to.

**Warning**: Rust-libp2p has never been tested at a scale of more than ~80 nodes. May or may not
work.

---
class: center, middle

# Thank you!

<div style="position: absolute; bottom: 5%; left: 5%;">
.left[
    (by the way, Parity is recruiting)
]
</div>

<div style="position: absolute; bottom: 5%; right: 5%;">
.right[
    twitter.com/tomaka17 <img src="twitter.png" alt="Twitter" height="16" /><br />
    github.com/tomaka <img src="github.png" alt="GitHub" height="16" /><br />
]
</div>

    </textarea>
     <script src="remark.min.js">
    </script>
    <script>
       var slideshow = remark.create();
    </script>
  </body>
</html>
